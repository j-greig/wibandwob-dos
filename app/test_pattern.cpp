/*---------------------------------------------------------*/
/*                                                         */
/*   test_pattern.cpp - Test Pattern Implementation       */
/*                                                         */
/*---------------------------------------------------------*/

#include "test_pattern.h"

// Define the 16 ANSI colors - foreground colored, background black for shade visibility
const TColorAttr TTestPattern::ansiColors[16] = {
    TColorAttr(TColorRGB(0x00, 0x00, 0x00), TColorRGB(0x00, 0x00, 0x00)),  // #000000 Black
    TColorAttr(TColorRGB(0x00, 0x00, 0x80), TColorRGB(0x00, 0x00, 0x00)),  // #000080 Blue
    TColorAttr(TColorRGB(0x00, 0x80, 0x00), TColorRGB(0x00, 0x00, 0x00)),  // #008000 Green
    TColorAttr(TColorRGB(0x00, 0x80, 0x80), TColorRGB(0x00, 0x00, 0x00)),  // #008080 Cyan
    TColorAttr(TColorRGB(0x80, 0x00, 0x00), TColorRGB(0x00, 0x00, 0x00)),  // #800000 Red
    TColorAttr(TColorRGB(0x80, 0x00, 0x80), TColorRGB(0x00, 0x00, 0x00)),  // #800080 Magenta
    TColorAttr(TColorRGB(0x80, 0x80, 0x00), TColorRGB(0x00, 0x00, 0x00)),  // #808000 Brown/Olive
    TColorAttr(TColorRGB(0xC0, 0xC0, 0xC0), TColorRGB(0x00, 0x00, 0x00)),  // #C0C0C0 Light Gray
    TColorAttr(TColorRGB(0x80, 0x80, 0x80), TColorRGB(0x00, 0x00, 0x00)),  // #808080 Dark Gray
    TColorAttr(TColorRGB(0x00, 0x00, 0xFF), TColorRGB(0x00, 0x00, 0x00)),  // #0000FF Light Blue
    TColorAttr(TColorRGB(0x00, 0xFF, 0x00), TColorRGB(0x00, 0x00, 0x00)),  // #00FF00 Light Green
    TColorAttr(TColorRGB(0x00, 0xFF, 0xFF), TColorRGB(0x00, 0x00, 0x00)),  // #00FFFF Light Cyan
    TColorAttr(TColorRGB(0xFF, 0x00, 0x00), TColorRGB(0x00, 0x00, 0x00)),  // #FF0000 Light Red
    TColorAttr(TColorRGB(0xFF, 0x00, 0xFF), TColorRGB(0x00, 0x00, 0x00)),  // #FF00FF Light Magenta
    TColorAttr(TColorRGB(0xFF, 0xFF, 0x00), TColorRGB(0x00, 0x00, 0x00)),  // #FFFF00 Yellow
    TColorAttr(TColorRGB(0xFF, 0xFF, 0xFF), TColorRGB(0x00, 0x00, 0x00))   // #FFFFFF White
};

// Define 16 grayscale shades - foreground gray, background black for shade visibility
const TColorAttr TTestPattern::grayShades[16] = {
    TColorAttr(TColorRGB(0x00, 0x00, 0x00), TColorRGB(0x00, 0x00, 0x00)),  // Black
    TColorAttr(TColorRGB(0x11, 0x11, 0x11), TColorRGB(0x00, 0x00, 0x00)),
    TColorAttr(TColorRGB(0x22, 0x22, 0x22), TColorRGB(0x00, 0x00, 0x00)),
    TColorAttr(TColorRGB(0x33, 0x33, 0x33), TColorRGB(0x00, 0x00, 0x00)),
    TColorAttr(TColorRGB(0x44, 0x44, 0x44), TColorRGB(0x00, 0x00, 0x00)),
    TColorAttr(TColorRGB(0x55, 0x55, 0x55), TColorRGB(0x00, 0x00, 0x00)),
    TColorAttr(TColorRGB(0x66, 0x66, 0x66), TColorRGB(0x00, 0x00, 0x00)),
    TColorAttr(TColorRGB(0x77, 0x77, 0x77), TColorRGB(0x00, 0x00, 0x00)),
    TColorAttr(TColorRGB(0x88, 0x88, 0x88), TColorRGB(0x00, 0x00, 0x00)),
    TColorAttr(TColorRGB(0x99, 0x99, 0x99), TColorRGB(0x00, 0x00, 0x00)),
    TColorAttr(TColorRGB(0xAA, 0xAA, 0xAA), TColorRGB(0x00, 0x00, 0x00)),
    TColorAttr(TColorRGB(0xBB, 0xBB, 0xBB), TColorRGB(0x00, 0x00, 0x00)),
    TColorAttr(TColorRGB(0xCC, 0xCC, 0xCC), TColorRGB(0x00, 0x00, 0x00)),
    TColorAttr(TColorRGB(0xDD, 0xDD, 0xDD), TColorRGB(0x00, 0x00, 0x00)),
    TColorAttr(TColorRGB(0xEE, 0xEE, 0xEE), TColorRGB(0x00, 0x00, 0x00)),
    TColorAttr(TColorRGB(0xFF, 0xFF, 0xFF), TColorRGB(0x00, 0x00, 0x00))   // White
};

void TTestPattern::drawPatternRow(TDrawBuffer& b, int row, int width, int offset)
{
    const TColorAttr* colors = (row % 2 == 0) ? ansiColors : grayShades;
    
    for (int x = 0; x < width; x++)
    {
        // Apply offset for continuous mode
        int colorIndex = (x + offset) % 16;
        // Use medium shade character to create textured blocks
        b.moveChar(x, '\xB1', colors[colorIndex], 1);
    }
}